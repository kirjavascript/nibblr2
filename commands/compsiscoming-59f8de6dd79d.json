{
    "name": "comps.iscoming",
    "command": "var url = \"\";\nvar comp_name = IRC.command.params[0];\ngetDOM(\"https://worldcubeassociation.org/competitions\")\n    .then(dom =>\n    {\n        const compLink = dom.qsa('.competition-link');\n        for (let i = 0; i < compLink.length; i++) {\n            if (compLink[i].children[1].textContent.replace(/\\s+/g, ' ').replace(/\\-/g, ' ').toLowerCase()\n                    .includes(comp_name.toLowerCase().replace(/\\-/g, ' '))) {\n                url+=(`https://worldcubeassociation.org${compLink[i].children[1].href}/registrations`);\n                comp_name = compLink[i].children[1].textContent;\n            }\n        }\n        getDOM(url)\n         .then(dom =>\n            {\n                const competitors = dom.qsa('.name');\n                var matches = [];\n                for (let i = 0; i < competitors.length; i++) {\n                    if (competitors[i].textContent.toLowerCase().includes(input.toLowerCase())) {\n                        matches.push(competitors[i].textContent.replace(/\\s+/g, ' '));\n                    }\n                }\n                \n                if (matches.length == 0) {\n                    print(`There is no ${input} registered for this competition`);\n                } else if (matches.length == 1) {\n                    print(`Yes, ${matches[0]} is coming to ${comp_name}`);\n                } else {\n                    print(`These competitors match the given name and are coming to ${comp_name}:`);\n                    for (let n = 0; n < matches.length; n++) {\n                        print(`${n+1}. ${matches[n]}`);\n                    }\n                }\n            }).catch(print.error)\n        }\n    )",
    "locked": false,
    "starred": false
}